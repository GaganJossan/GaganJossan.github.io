<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FL Coaches Corner</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div id="menuButton">
            <img src="data:image/jpeg;base64,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" alt="Menu Icon">
        </div>
        <div id="logoTitleContainer">
            <img src="https://1000logos.net/wp-content/uploads/2017/08/Lululemon-Logo.png" alt="Lululemon Logo" id="logoImage">
            <h1>FL Coaches Corner</h1>
        </div>
        <div id="searchContainer">
            <input type="text" id="searchBar" placeholder="Search by associate user ID...">
            <button id="searchButton">Search</button>
        </div>
    </header>
    <div id="menuOverlay"></div>
    <div id="menu">
        <h2>Menu</h2>
        <a href="#" id="flFeedbacksOverview">FL Feedbacks Overview</a>
    </div>
    <main>
        <section id="feedbackFormSection">
            <h2>Add Feedback</h2>
            <form id="feedbackForm">
                <label for="dateOfCoaching">Date of Coaching:</label>
                <input type="date" id="dateOfCoaching" required>
                
                <label for="flSubmitted">FL Submitted:</label>
                <input type="text" id="flSubmitted" required>
                
                <label for="topicBulletPoint">Topic:</label>
                <select id="topicBulletPoint" required>
                    <option value="UPH">UPH</option>
                    <option value="Shoutout">Shoutout</option>
                    <option value="Repeat Coaching">Repeat Coaching</option>
                    <option value="Coaching">Coaching</option>
                    <option value="Training">Training</option>
                </select>
                
                <label for="associateName">Associate User ID:</label>
                <input type="text" id="associateName" required>
                
                <label for="feedbackText">Feedback:</label>
                <textarea id="feedbackText" placeholder="Enter feedback here..." required></textarea>
                
                <button type="submit">Submit Feedback</button>
            </form>
        </section>
        <section id="searchResults" style="display: none;">
            <h2>Feedback Summary for <span id="summaryAssociateName"></span></h2>
            <table>
                <thead>
                    <tr>
                        <th>Topic</th>
                        <th>Sum of Events</th>
                    </tr>
                </thead>
                <tbody id="feedbackSummary"></tbody>
            </table>
            <button id="backToMainButton">Back to Main</button>
        </section>
        <section id="detailView" style="display: none;">
            <h2>Detail View</h2>
            <table id="detailTable">
                <thead>
                    <tr>
                        <th>Date Submitted</th>
                        <th>Topic</th>
                        <th>Feedback</th>
                        <th>Submitted By</th>
                        <th>Associate Name</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Detailed rows will be added here -->
                </tbody>
            </table>
            <button id="backToSummaryButton">Back to Summary</button>
        </section>
        <section id="flOverviewSection" style="display: none;">
            <h2>FL Feedbacks Overview</h2>
            <table>
                <thead>
                    <tr>
                        <th>FL Name</th>
                        <th>Total Feedback Provided</th>
                    </tr>
                </thead>
                <tbody id="flOverviewBody"></tbody>
            </table>
            <button id="backToMainFromOverviewButton">Back to Main</button>
        </section>
        <section id="flDetailView" style="display: none;">
            <h2>FL Feedback Details</h2>
            <table id="flDetailTable">
                <thead>
                    <tr>
                        <th>Date Submitted</th>
                        <th>Topic</th>
                        <th>Feedback</th>
                        <th>Submitted By</th>
                        <th>Associate Name</th>
                    </tr>
                </thead>
                <tbody id="flDetailTableBody"></tbody>
            </table>
            <button id="backToOverviewButton">Back to Overview</button>
        </section>
    </main>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-analytics.js";
      import { getDatabase, ref, set, push, onValue, orderByChild, query, startAt, endAt } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-database.js";

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyDvkJUQFsAGDQNY__TmKUvom7HkvK_OEsI",
        authDomain: "fl-coaches-corner.firebaseapp.com",
        databaseURL: "https://fl-coaches-corner-default-rtdb.firebaseio.com",
        projectId: "fl-coaches-corner",
        storageBucket: "fl-coaches-corner.appspot.com",
        messagingSenderId: "748798786709",
        appId: "1:748798786709:web:dc7bf765761812489e6f9c",
        measurementId: "G-G0RY03B6D3"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
      const database = getDatabase(app);

      // Reference to feedback data in Firebase
      const feedbackRef = ref(database, 'feedbacks');

      // Add feedback to Firebase
      function addFeedback(feedback) {
        push(feedbackRef, feedback);
      }

      // Fetch feedbacks from Firebase based on associateName
      function fetchFeedbacks(associateName, callback) {
        const feedbackQuery = query(feedbackRef, orderByChild('associateName'), startAt(associateName), endAt(associateName + "\uf8ff"));
        onValue(feedbackQuery, (snapshot) => {
          const feedbacks = [];
          snapshot.forEach((childSnapshot) => {
            feedbacks.push(childSnapshot.val());
          });
          callback(feedbacks);
        });
      }

      // Fetch FL feedback overview
      function fetchFLFeedbacksOverview(callback) {
        onValue(feedbackRef, (snapshot) => {
          const flFeedbacks = {};
          snapshot.forEach((childSnapshot) => {
            const feedback = childSnapshot.val();
            const flName = feedback.flSubmitted.toLowerCase();
            if (!flFeedbacks[flName]) {
              flFeedbacks[flName] = { name: feedback.flSubmitted, count: 0 };
            }
            flFeedbacks[flName].count++;
          });
          callback(flFeedbacks);
        });
      }

      // Fetch detailed feedback for a specific FL
      function fetchFLDetails(flName, callback) {
        const feedbackQuery = query(feedbackRef, orderByChild('flSubmitted'), startAt(flName), endAt(flName + "\uf8ff"));
        onValue(feedbackQuery, (snapshot) => {
          const feedbacks = [];
          snapshot.forEach((childSnapshot) => {
            feedbacks.push(childSnapshot.val());
          });
          callback(feedbacks);
        });
      }

      document.addEventListener('DOMContentLoaded', () => {
        // Event listener for the feedback form submission
        document.getElementById('feedbackForm').addEventListener('submit', (event) => {
          event.preventDefault();

          const dateOfCoaching = document.getElementById('dateOfCoaching').value;
          const flSubmitted = document.getElementById('flSubmitted').value.trim();
          const topicBulletPoint = document.getElementById('topicBulletPoint').value;
          const associateName = document.getElementById('associateName').value.trim();
          const feedbackText = document.getElementById('feedbackText').value.trim();

          if (!dateOfCoaching || !flSubmitted || !topicBulletPoint || !associateName || !feedbackText) {
            alert('Please fill in all fields before submitting.');
            return;
          }

          const feedback = {
            date: new Date().toISOString().slice(0, 10),
            flSubmitted: flSubmitted,
            topic: topicBulletPoint,
            associateName: associateName,
            feedback: feedbackText
          };

          addFeedback(feedback);
          document.getElementById('feedbackForm').reset();
          alert('Feedback submitted successfully!');
        });

        // Event listener for search button click
        document.getElementById('searchButton').addEventListener('click', () => {
          const searchBar = document.getElementById('searchBar');
          const searchName = searchBar.value.trim().toLowerCase();
          if (searchName) {
            fetchFeedbacks(searchName, (feedbacks) => {
              displayFeedbackSummary(searchName, feedbacks);
            });
          } else {
            alert('Please enter an associate user ID.');
          }
        });

        // Function to display feedback summary
        function displayFeedbackSummary(searchName, feedbacks) {
          const summaryAssociateName = document.getElementById('summaryAssociateName');
          const feedbackSummary = document.getElementById('feedbackSummary');
          const searchResults = document.getElementById('searchResults');
          const feedbackFormSection = document.getElementById('feedbackFormSection');
          const detailView = document.getElementById('detailView');
          const backToMainButton = document.getElementById('backToMainButton');
          const backToSummaryButton = document.getElementById('backToSummaryButton');

          // Add event listeners for navigation buttons
          backToMainButton.addEventListener('click', () => {
            feedbackFormSection.style.display = 'block';
            searchResults.style.display = 'none';
            detailView.style.display = 'none';
          });

          backToSummaryButton.addEventListener('click', () => {
            detailView.style.display = 'none';
            searchResults.style.display = 'block';
          });

          let displayName = searchName.charAt(0).toUpperCase() + searchName.slice(1);
          summaryAssociateName.textContent = displayName;
          feedbackSummary.innerHTML = '';
          let topics = {};

          feedbacks.forEach(f => {
            if (!topics[f.topic]) {
              topics[f.topic] = [];
            }
            topics[f.topic].push(f);
          });

          for (let topic in topics) {
            let row = feedbackSummary.insertRow();
            let topicCell = row.insertCell(0);
            let button = document.createElement('button');
            button.textContent = topic;
            button.onclick = () => displayDetails(topics[topic]);
            button.style.cursor = 'pointer';
            topicCell.appendChild(button);
            row.insertCell(1).textContent = topics[topic].length;
          }

          searchResults.style.display = 'block';
          feedbackFormSection.style.display = 'none';
        }

        // Function to display detailed feedback
        function displayDetails(topicFeedbacks) {
          const detailTableBody = document.querySelector('#detailTable tbody');
          const detailView = document.getElementById('detailView');
          const searchResults = document.getElementById('searchResults');

          detailTableBody.innerHTML = '';
          topicFeedbacks.forEach(f => {
            let row = detailTableBody.insertRow();
            row.insertCell(0).textContent = f.date;
            row.insertCell(1).textContent = f.topic;
            row.insertCell(2).textContent = f.feedback;
            row.insertCell(3).textContent = f.flSubmitted;
            row.insertCell(4).textContent = f.associateName;
          });

          detailView.style.display = 'block';
          searchResults.style.display = 'none';
        }

        // Menu button functionality
        const menuButton = document.getElementById('menuButton');
        const menuOverlay = document.getElementById('menuOverlay');
        const menu = document.getElementById('menu');

        menuButton.addEventListener('click', () => {
          menu.classList.toggle('open');
          menuOverlay.style.display = menu.classList.contains('open') ? 'block' : 'none';
        });

        menuOverlay.addEventListener('click', () => {
          menu.classList.remove('open');
          menuOverlay.style.display = 'none';
        });

        // Event listener for FL Feedbacks Overview link
        document.getElementById('flFeedbacksOverview').addEventListener('click', (event) => {
          event.preventDefault();
          fetchFLFeedbacksOverview((flFeedbacks) => {
            displayFLFeedbacksOverview(flFeedbacks);
          });
        });

        // Function to display FL feedback overview
        function displayFLFeedbacksOverview(flFeedbacks) {
          const flOverviewSection = document.getElementById('flOverviewSection');
          const feedbackFormSection = document.getElementById('feedbackFormSection');
          const searchResults = document.getElementById('searchResults');
          const detailView = document.getElementById('detailView');
          const flOverviewBody = document.getElementById('flOverviewBody');
          const backToMainFromOverviewButton = document.getElementById('backToMainFromOverviewButton');

          // Add event listener for back button
          backToMainFromOverviewButton.addEventListener('click', () => {
            flOverviewSection.style.display = 'none';
            feedbackFormSection.style.display = 'block';
          });

          flOverviewBody.innerHTML = '';
          for (let fl in flFeedbacks) {
            let row = flOverviewBody.insertRow();
            let flCell = row.insertCell(0);
            let button = document.createElement('button');
            button.textContent = flFeedbacks[fl].name;
            button.onclick = () => displayFLDetails(flFeedbacks[fl].name);
            button.style.cursor = 'pointer';
            flCell.appendChild(button);
            row.insertCell(1).textContent = flFeedbacks[fl].count;
          }

          flOverviewSection.style.display = 'block';
          feedbackFormSection.style.display = 'none';
          searchResults.style.display = 'none';
          detailView.style.display = 'none';
        }

        // Function to display detailed feedback for a specific FL
        function displayFLDetails(flName) {
          fetchFLDetails(flName, (feedbacks) => {
            const flDetailView = document.getElementById('flDetailView');
            const flDetailTableBody = document.getElementById('flDetailTableBody');
            const flOverviewSection = document.getElementById('flOverviewSection');
            const backToOverviewButton = document.getElementById('backToOverviewButton');

            // Add event listener for back button
            backToOverviewButton.addEventListener('click', () => {
              flDetailView.style.display = 'none';
              flOverviewSection.style.display = 'block';
            });

            flDetailTableBody.innerHTML = '';
            feedbacks.forEach(f => {
              let row = flDetailTableBody.insertRow();
              row.insertCell(0).textContent = f.date;
              row.insertCell(1).textContent = f.topic;
              row.insertCell(2).textContent = f.feedback;
              row.insertCell(3).textContent = f.flSubmitted;
              row.insertCell(4).textContent = f.associateName;
            });

            flDetailView.style.display = 'block';
            flOverviewSection.style.display = 'none';
          });
        }
      });
    </script>
</body>
</html>
